"use strict";(globalThis.webpackChunkfrontend_book=globalThis.webpackChunkfrontend_book||[]).push([[122],{3023(e,n,i){i.d(n,{R:()=>r,x:()=>l});var s=i(3696);const o={},t=s.createContext(o);function r(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(t.Provider,{value:n},e.children)}},4511(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var s=i(2540),o=i(3023);const t={title:"ROS 2 Fundamentals for Humanoids",sidebar_position:2,description:"Learn core ROS 2 concepts for humanoid robots"},r="ROS 2 Fundamentals for Humanoids",l={id:"module1/ros2-fundamentals",title:"ROS 2 Fundamentals for Humanoids",description:"Learn core ROS 2 concepts for humanoid robots",source:"@site/docs/module1/ros2-fundamentals.md",sourceDirName:"module1",slug:"/module1/ros2-fundamentals",permalink:"/docs/module1/ros2-fundamentals",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module1/ros2-fundamentals.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"ROS 2 Fundamentals for Humanoids",sidebar_position:2,description:"Learn core ROS 2 concepts for humanoid robots"},sidebar:"tutorialSidebar",previous:{title:"Introduction to ROS 2 for Humanoid Robotics",permalink:"/docs/intro"},next:{title:"Gazebo Physics Simulation",permalink:"/docs/module2/gazebo-physics"}},a={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Learning Objectives Validation",id:"learning-objectives-validation",level:2},{value:"Introduction to ROS 2",id:"introduction-to-ros-2",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"Nodes",id:"nodes",level:3},{value:"Topics and Messages",id:"topics-and-messages",level:3},{value:"Services",id:"services",level:3},{value:"Actions",id:"actions",level:3},{value:"ROS 2 Workspace Setup",id:"ros-2-workspace-setup",level:2},{value:"Creating a Workspace",id:"creating-a-workspace",level:3},{value:"Building the Workspace",id:"building-the-workspace",level:3},{value:"Publisher-Subscriber Example for Joint Commands",id:"publisher-subscriber-example-for-joint-commands",level:2},{value:"Publisher Node",id:"publisher-node",level:3},{value:"Subscriber Node",id:"subscriber-node",level:3},{value:"Running the Example",id:"running-the-example",level:2},{value:"Advanced ROS 2 Concepts for Humanoid Robotics",id:"advanced-ros-2-concepts-for-humanoid-robotics",level:2},{value:"Quality of Service (QoS) Settings",id:"quality-of-service-qos-settings",level:3},{value:"Lifecycle Nodes",id:"lifecycle-nodes",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Timers",id:"timers",level:3},{value:"Working with ROS 2 Tools",id:"working-with-ros-2-tools",level:2},{value:"Command Line Tools",id:"command-line-tools",level:3},{value:"Launch Files",id:"launch-files",level:3},{value:"Best Practices for Humanoid Robotics",id:"best-practices-for-humanoid-robotics",level:2},{value:"Message Types for Humanoid Robotics",id:"message-types-for-humanoid-robotics",level:2},{value:"Joint State Messages",id:"joint-state-messages",level:3},{value:"Twist Messages",id:"twist-messages",level:3},{value:"Custom Message Types",id:"custom-message-types",level:3},{value:"Creating a Simple Controller Node",id:"creating-a-simple-controller-node",level:2},{value:"Debugging and Troubleshooting",id:"debugging-and-troubleshooting",level:2},{value:"Node Communication Issues",id:"node-communication-issues",level:3},{value:"Performance Issues",id:"performance-issues",level:3},{value:"Memory Management",id:"memory-management",level:3},{value:"Exercises",id:"exercises",level:2},{value:"Summary",id:"summary",level:2},{value:"References to Official ROS 2 Documentation",id:"references-to-official-ros-2-documentation",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"ros-2-fundamentals-for-humanoids",children:"ROS 2 Fundamentals for Humanoids"}),"\n",(0,s.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Understand ROS 2 nodes, topics, services, and actions"}),"\n",(0,s.jsx)(n.li,{children:"Set up a ROS 2 workspace for humanoid robotics"}),"\n",(0,s.jsx)(n.li,{children:"Create a simple publisher-subscriber example for joint commands"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"learning-objectives-validation",children:"Learning Objectives Validation"}),"\n",(0,s.jsx)(n.p,{children:"Let's validate that each learning objective has been met:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Understanding ROS 2 nodes, topics, services, and actions"}),": This objective has been met through detailed explanations of each concept, their purposes, and how they work in the context of humanoid robotics. You've learned about the publish-subscribe model, request-response communication, and long-running tasks with feedback."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Setting up a ROS 2 workspace for humanoid robotics"}),": This objective has been met by covering the workspace structure, creation process, and build procedures. You now understand the typical directory structure and how to initialize and build a ROS 2 workspace."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Creating a simple publisher-subscriber example for joint commands"}),": This objective has been met with practical Python examples showing how to create publisher and subscriber nodes. You've seen how to implement these nodes for joint command communication in humanoid robots, including proper ROS 2 node structure and message handling."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"introduction-to-ros-2",children:"Introduction to ROS 2"}),"\n",(0,s.jsx)(n.p,{children:"ROS 2 (Robot Operating System 2) is a flexible framework for writing robot software. It's a collection of tools, libraries, and conventions that aim to simplify the task of creating complex and robust robot behavior across a wide variety of robot platforms."}),"\n",(0,s.jsx)(n.p,{children:"For humanoid robotics, ROS 2 provides the communication infrastructure needed to coordinate between different subsystems like perception, planning, control, and actuation."}),"\n",(0,s.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,s.jsx)(n.h3,{id:"nodes",children:"Nodes"}),"\n",(0,s.jsxs)(n.p,{children:["A node is a process that performs computation. In ROS 2, nodes are written using client libraries such as ",(0,s.jsx)(n.code,{children:"rclpy"})," (Python) or ",(0,s.jsx)(n.code,{children:"rclcpp"})," (C++). Nodes are the fundamental building blocks of a ROS program."]}),"\n",(0,s.jsx)(n.p,{children:"For humanoid robots, you might have nodes for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Joint controllers"}),"\n",(0,s.jsx)(n.li,{children:"Sensor processing"}),"\n",(0,s.jsx)(n.li,{children:"Motion planning"}),"\n",(0,s.jsx)(n.li,{children:"Perception systems"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"topics-and-messages",children:"Topics and Messages"}),"\n",(0,s.jsx)(n.p,{children:"Topics enable asynchronous message passing between nodes. A node can publish messages to a topic, and other nodes can subscribe to that topic to receive the messages."}),"\n",(0,s.jsx)(n.p,{children:"In humanoid robotics, common topics include:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Joint states (",(0,s.jsx)(n.code,{children:"sensor_msgs/JointState"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Twist commands for base movement (",(0,s.jsx)(n.code,{children:"geometry_msgs/Twist"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Sensor data from cameras, IMUs, etc."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"services",children:"Services"}),"\n",(0,s.jsx)(n.p,{children:"Services provide synchronous request/response communication. A service has a client that sends a request and a server that processes the request and returns a response."}),"\n",(0,s.jsx)(n.p,{children:"For humanoid robots, services might include:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Calibration routines"}),"\n",(0,s.jsx)(n.li,{children:"Mode switching"}),"\n",(0,s.jsx)(n.li,{children:"Emergency stop activation"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"actions",children:"Actions"}),"\n",(0,s.jsx)(n.p,{children:"Actions are used for long-running tasks that require feedback and the ability to cancel. They extend the service paradigm with additional features for tracking progress."}),"\n",(0,s.jsx)(n.p,{children:"For humanoid robots, actions are often used for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Walking patterns"}),"\n",(0,s.jsx)(n.li,{children:"Arm trajectories"}),"\n",(0,s.jsx)(n.li,{children:"Complex manipulation tasks"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"ros-2-workspace-setup",children:"ROS 2 Workspace Setup"}),"\n",(0,s.jsx)(n.p,{children:"A ROS 2 workspace is a directory where you modify, build, and install ROS 2 packages."}),"\n",(0,s.jsx)(n.h3,{id:"creating-a-workspace",children:"Creating a Workspace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src\ncd ~/ros2_ws\n"})}),"\n",(0,s.jsx)(n.h3,{id:"building-the-workspace",children:"Building the Workspace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"colcon build\nsource install/setup.bash\n"})}),"\n",(0,s.jsx)(n.h2,{id:"publisher-subscriber-example-for-joint-commands",children:"Publisher-Subscriber Example for Joint Commands"}),"\n",(0,s.jsx)(n.p,{children:"Let's create a simple publisher-subscriber example for joint commands, which is fundamental for controlling humanoid robot joints."}),"\n",(0,s.jsx)(n.h3,{id:"publisher-node",children:"Publisher Node"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass JointCommandPublisher(Node):\n    def __init__(self):\n        super().__init__('joint_command_publisher')\n        self.publisher_ = self.create_publisher(String, 'joint_commands', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Joint command: {self.i}'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    joint_command_publisher = JointCommandPublisher()\n    rclpy.spin(joint_command_publisher)\n    joint_command_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h3,{id:"subscriber-node",children:"Subscriber Node"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass JointCommandSubscriber(Node):\n    def __init__(self):\n        super().__init__('joint_command_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'joint_commands',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    joint_command_subscriber = JointCommandSubscriber()\n    rclpy.spin(joint_command_subscriber)\n    joint_command_subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"running-the-example",children:"Running the Example"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Save the publisher code as ",(0,s.jsx)(n.code,{children:"joint_publisher.py"})," and the subscriber code as ",(0,s.jsx)(n.code,{children:"joint_subscriber.py"})]}),"\n",(0,s.jsxs)(n.li,{children:["Build your workspace: ",(0,s.jsx)(n.code,{children:"colcon build"})]}),"\n",(0,s.jsxs)(n.li,{children:["Source the setup file: ",(0,s.jsx)(n.code,{children:"source install/setup.bash"})]}),"\n",(0,s.jsxs)(n.li,{children:["Run the publisher: ",(0,s.jsx)(n.code,{children:"ros2 run <package_name> joint_publisher"})]}),"\n",(0,s.jsxs)(n.li,{children:["In another terminal, run the subscriber: ",(0,s.jsx)(n.code,{children:"ros2 run <package_name> joint_subscriber"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"advanced-ros-2-concepts-for-humanoid-robotics",children:"Advanced ROS 2 Concepts for Humanoid Robotics"}),"\n",(0,s.jsx)(n.h3,{id:"quality-of-service-qos-settings",children:"Quality of Service (QoS) Settings"}),"\n",(0,s.jsx)(n.p,{children:"In humanoid robotics applications, Quality of Service (QoS) settings are crucial for ensuring reliable communication between nodes. QoS profiles allow you to specify how messages are handled in terms of reliability, durability, and history."}),"\n",(0,s.jsx)(n.p,{children:"For joint command topics in humanoid robots, you might want to use reliable reliability and keep-all history:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, QoSReliabilityPolicy, QoSHistoryPolicy\n\nqos_profile = QoSProfile(\n    depth=10,\n    reliability=QoSReliabilityPolicy.RELIABLE,\n    history=QoSHistoryPolicy.KEEP_ALL\n)\n\nself.publisher = self.create_publisher(\n    Float64MultiArray,\n    'joint_commands',\n    qos_profile\n)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"lifecycle-nodes",children:"Lifecycle Nodes"}),"\n",(0,s.jsx)(n.p,{children:"For humanoid robots that require complex state management, lifecycle nodes provide a way to manage the state of your nodes explicitly. This is useful for robots that need to go through initialization, activation, and deactivation sequences."}),"\n",(0,s.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsx)(n.p,{children:"ROS 2 parameters allow you to configure nodes at runtime. For humanoid robots, you might have parameters for joint limits, safety thresholds, or controller gains:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"self.declare_parameter('max_joint_velocity', 1.0)\nmax_vel = self.get_parameter('max_joint_velocity').value\n"})}),"\n",(0,s.jsx)(n.h3,{id:"timers",children:"Timers"}),"\n",(0,s.jsx)(n.p,{children:"Timers in ROS 2 allow you to execute callbacks at specific rates. For humanoid robot control, you might need precise timing for control loops:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"timer_period = 0.01  # 10ms for 100Hz control loop\nself.timer = self.create_timer(timer_period, self.control_callback)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"working-with-ros-2-tools",children:"Working with ROS 2 Tools"}),"\n",(0,s.jsx)(n.h3,{id:"command-line-tools",children:"Command Line Tools"}),"\n",(0,s.jsx)(n.p,{children:"ROS 2 provides several command-line tools for debugging and introspecting your system:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ros2 node list"})," - List all active nodes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ros2 topic list"})," - List all active topics"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ros2 topic echo <topic_name>"})," - Print messages from a topic"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ros2 service list"})," - List all available services"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ros2 action list"})," - List all available actions"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"launch-files",children:"Launch Files"}),"\n",(0,s.jsx)(n.p,{children:"Launch files allow you to start multiple nodes with a single command. For humanoid robots, you might have launch files that start all necessary nodes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    return LaunchDescription([\n        Node(\n            package='my_robot_hardware',\n            executable='joint_state_publisher',\n            name='joint_state_publisher'\n        ),\n        Node(\n            package='my_robot_control',\n            executable='controller_manager',\n            name='controller_manager'\n        )\n    ])\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices-for-humanoid-robotics",children:"Best Practices for Humanoid Robotics"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Modularity"}),": Design your system with modular nodes that have clear responsibilities"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Safety"}),": Implement safety checks in your nodes to prevent dangerous robot behavior"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Monitoring"}),": Use ROS 2's built-in monitoring tools to track node health"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Documentation"}),": Document your custom message types and services"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Testing"}),": Write tests for your nodes using ROS 2's testing frameworks"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"message-types-for-humanoid-robotics",children:"Message Types for Humanoid Robotics"}),"\n",(0,s.jsx)(n.p,{children:"ROS 2 provides several standard message types that are particularly useful for humanoid robotics:"}),"\n",(0,s.jsx)(n.h3,{id:"joint-state-messages",children:"Joint State Messages"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"sensor_msgs/JointState"})," message is essential for humanoid robots to communicate joint positions, velocities, and efforts:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from sensor_msgs.msg import JointState\n\n# Example joint state message for a humanoid with 24 DOF\njoint_state = JointState()\njoint_state.name = [\n    'left_hip_yaw', 'left_hip_roll', 'left_hip_pitch', 'left_knee',\n    'left_ankle_pitch', 'left_ankle_roll', 'right_hip_yaw', 'right_hip_roll',\n    'right_hip_pitch', 'right_knee', 'right_ankle_pitch', 'right_ankle_roll',\n    'torso_yaw', 'left_shoulder_pitch', 'left_shoulder_roll', 'left_elbow',\n    'right_shoulder_pitch', 'right_shoulder_roll', 'right_elbow',\n    'neck_yaw', 'neck_pitch', 'neck_roll', 'head_pan', 'head_tilt'\n]\n\njoint_state.position = [0.0] * 24  # Initialize all joints to 0 position\njoint_state.velocity = [0.0] * 24  # Initialize all velocities to 0\njoint_state.effort = [0.0] * 24    # Initialize all efforts to 0\n"})}),"\n",(0,s.jsx)(n.h3,{id:"twist-messages",children:"Twist Messages"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"geometry_msgs/Twist"})," message is used for specifying linear and angular velocities, which is important for humanoid base movement:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from geometry_msgs.msg import Twist\n\ntwist = Twist()\ntwist.linear.x = 0.1  # Forward velocity in m/s\ntwist.linear.y = 0.0  # Lateral velocity\ntwist.linear.z = 0.0  # Vertical velocity\ntwist.angular.x = 0.0 # Angular velocity around X-axis\ntwist.angular.y = 0.0 # Angular velocity around Y-axis\ntwist.angular.z = 0.1 # Angular velocity around Z-axis (turning)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"custom-message-types",children:"Custom Message Types"}),"\n",(0,s.jsx)(n.p,{children:"For humanoid robotics, you may need to create custom message types for specific applications. To create a custom message:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a ",(0,s.jsx)(n.code,{children:"msg"})," directory in your package"]}),"\n",(0,s.jsxs)(n.li,{children:["Define your message in a ",(0,s.jsx)(n.code,{children:".msg"})," file (e.g., ",(0,s.jsx)(n.code,{children:"HumanoidCommand.msg"}),"):"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"float64[24] joint_positions\nfloat64[24] joint_velocities\nfloat64[24] joint_efforts\nstring command_type\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:"Add the message to your CMakeLists.txt for generation"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"creating-a-simple-controller-node",children:"Creating a Simple Controller Node"}),"\n",(0,s.jsx)(n.p,{children:"Let's create a more sophisticated controller node that processes joint commands and sends them to the robot hardware:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState\nfrom std_msgs.msg import String\nimport numpy as np\n\nclass HumanoidController(Node):\n    def __init__(self):\n        super().__init__('humanoid_controller')\n\n        # Subscriber for joint commands\n        self.command_subscriber = self.create_subscription(\n            String,\n            'joint_commands',\n            self.command_callback,\n            10\n        )\n\n        # Publisher for joint states\n        self.joint_state_publisher = self.create_publisher(\n            JointState,\n            'joint_states',\n            10\n        )\n\n        # Timer for control loop\n        self.control_timer = self.create_timer(0.01, self.control_loop)  # 100 Hz\n\n        # Initialize joint state\n        self.joint_state = JointState()\n        self.joint_state.name = [\n            'left_hip_yaw', 'left_hip_roll', 'left_hip_pitch', 'left_knee',\n            'left_ankle_pitch', 'left_ankle_roll', 'right_hip_yaw', 'right_hip_roll',\n            'right_hip_pitch', 'right_knee', 'right_ankle_pitch', 'right_ankle_roll',\n            'torso_yaw', 'left_shoulder_pitch', 'left_shoulder_roll', 'left_elbow',\n            'right_shoulder_pitch', 'right_shoulder_roll', 'right_elbow',\n            'neck_yaw', 'neck_pitch', 'neck_roll', 'head_pan', 'head_tilt'\n        ]\n        self.joint_state.position = [0.0] * 24\n        self.joint_state.velocity = [0.0] * 24\n        self.joint_state.effort = [0.0] * 24\n\n        self.target_positions = [0.0] * 24\n        self.get_logger().info('Humanoid Controller initialized')\n\n    def command_callback(self, msg):\n        try:\n            # Parse command string - in real application this would be more robust\n            cmd_parts = msg.data.split(':')\n            if len(cmd_parts) == 2 and cmd_parts[0] == 'Joint command':\n                # Update target positions based on command\n                idx = int(cmd_parts[1]) % 24\n                self.target_positions[idx] = float(cmd_parts[1]) * 0.1\n        except Exception as e:\n            self.get_logger().error(f'Error parsing command: {e}')\n\n    def control_loop(self):\n        # Simple PD controller for each joint\n        kp = 10.0  # Proportional gain\n        kd = 1.0   # Derivative gain\n\n        for i in range(24):\n            error = self.target_positions[i] - self.joint_state.position[i]\n            velocity = (self.target_positions[i] - self.joint_state.position[i]) / 0.01\n            control_effort = kp * error + kd * velocity\n\n            # Update joint state with new position (simplified model)\n            self.joint_state.position[i] += control_effort * 0.01  # dt = 0.01s\n            self.joint_state.velocity[i] = velocity\n            self.joint_state.effort[i] = control_effort\n\n        # Publish updated joint state\n        self.joint_state.header.stamp = self.get_clock().now().to_msg()\n        self.joint_state.header.frame_id = 'base_link'\n        self.joint_state_publisher.publish(self.joint_state)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    controller = HumanoidController()\n    rclpy.spin(controller)\n    controller.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"debugging-and-troubleshooting",children:"Debugging and Troubleshooting"}),"\n",(0,s.jsx)(n.p,{children:"When working with ROS 2 in humanoid robotics, you'll encounter various issues. Here are common debugging strategies:"}),"\n",(0,s.jsx)(n.h3,{id:"node-communication-issues",children:"Node Communication Issues"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"ros2 topic list"})," to verify topics exist"]}),"\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"ros2 topic info <topic_name>"})," to check publisher/subscriber counts"]}),"\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"ros2 topic echo <topic_name>"})," to verify data is flowing"]}),"\n",(0,s.jsx)(n.li,{children:"Check QoS settings match between publishers and subscribers"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance-issues",children:"Performance Issues"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Monitor CPU usage with ",(0,s.jsx)(n.code,{children:"top"})," or ",(0,s.jsx)(n.code,{children:"htop"})]}),"\n",(0,s.jsx)(n.li,{children:"Check network bandwidth if using multi-machine setup"}),"\n",(0,s.jsx)(n.li,{children:"Use appropriate QoS settings (reliable vs best-effort)"}),"\n",(0,s.jsx)(n.li,{children:"Profile your nodes to identify bottlenecks"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"memory-management",children:"Memory Management"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Be careful with message allocation in high-frequency loops"}),"\n",(0,s.jsx)(n.li,{children:"Use intraprocess communication when possible for better performance"}),"\n",(0,s.jsx)(n.li,{children:"Monitor memory usage with ROS 2 tools"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create a parameter server node that manages joint limits for your humanoid robot"}),"\n",(0,s.jsx)(n.li,{children:"Implement a lifecycle node for robot state management (idle, active, emergency_stop)"}),"\n",(0,s.jsx)(n.li,{children:"Create a launch file that starts both the publisher and subscriber nodes"}),"\n",(0,s.jsx)(n.li,{children:"Use QoS settings to ensure reliable delivery of critical joint commands"}),"\n",(0,s.jsx)(n.li,{children:"Implement a simple service that returns the current joint positions"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(n.p,{children:"In this chapter, we covered the fundamental concepts of ROS 2 that are essential for working with humanoid robots. Understanding nodes, topics, services, and actions is crucial for building robust robotic systems. The publisher-subscriber pattern is particularly important for the distributed nature of humanoid robot control systems."}),"\n",(0,s.jsx)(n.p,{children:"We also explored advanced concepts like QoS settings, lifecycle nodes, parameters, and timers that are important for real-world humanoid robotics applications. Additionally, we looked at ROS 2 tools for debugging and introspection, as well as best practices for developing humanoid robot systems."}),"\n",(0,s.jsx)(n.p,{children:"In the next chapter, we'll explore how to design Python AI agents that interface with ROS 2 using rclpy, building on the foundational concepts we've learned here."}),"\n",(0,s.jsx)(n.h2,{id:"references-to-official-ros-2-documentation",children:"References to Official ROS 2 Documentation"}),"\n",(0,s.jsx)(n.p,{children:"This chapter's content is based on the official ROS 2 documentation. For more detailed information, please refer to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/",children:"ROS 2 Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials.html",children:"ROS 2 Tutorials"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Concepts.html",children:"ROS 2 Concepts"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/p/rclpy/",children:"rclpy API Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Concepts/About-ROS-Interfaces.html",children:"ROS 2 Message Types"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Concepts/About-Quality-of-Service-Settings.html",children:"Quality of Service Settings"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Intermediate/Launch/Creating-Launch-Files.html",children:"ROS 2 Launch Files"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);